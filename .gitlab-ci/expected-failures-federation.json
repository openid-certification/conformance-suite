[
    {
        "test-name": "openid-federation-entity-configuration",
        "variant": "*",
        "configuration-filename": "*sweden-federation-intermediate.json",
        "current-block": "*",
        "condition": "ValidateAbsenceOfFederationEntityMetadata",
        "expected-result": "failure",
        "comment": "-"
    },
    {
        "test-name": "openid-federation-entity-configuration",
        "variant": "*",
        "configuration-filename": "*sweden-federation-bankid.json",
        "current-block": "Validating subordinate statement by immediate superior https://sandbox.swedenconnect.se/oidfed/intermediate",
        "condition": "ValidateAbsenceOfAuthorityHints",
        "expected-result": "failure",
        "comment": "Expected spec violation by third party"
    },

    {
        "test-name": "openid-federation-compare-trust-chain-to-resolve",
        "variant": "*",
        "configuration-filename": "*sweden-federation-bankid.json",
        "current-block": "*",
        "condition": "EnsureContentTypeEntityStatementJwt",
        "expected-result": "failure",
        "comment": "The entity under test does not publish federation metadata"
    },
    {
        "test-name": "openid-federation-compare-trust-chain-to-resolve",
        "variant": "*",
        "configuration-filename": "*sweden-federation-bankid.json",
        "current-block": "*",
        "condition": "ExtractJWTFromFederationEndpointResponse",
        "expected-result": "failure",
        "comment": "The entity under test does not publish federation metadata"
    },

    {
        "test-name": "openid-federation-compare-trust-chain-to-resolve",
        "variant": "*",
        "configuration-filename": "*sweden-federation-trust-anchor.json",
        "current-block": "*",
        "condition": "EnsureHttpStatusCodeIs200",
        "expected-result": "failure",
        "comment": "The entity has not been updated with the latest spec change on the anchor -> trust_anchor parameter name change on the resolve endpoint"
    },
    {
        "test-name": "openid-federation-compare-trust-chain-to-resolve",
        "variant": "*",
        "configuration-filename": "*sweden-federation-trust-anchor.json",
        "current-block": "*",
        "condition": "EnsureContentTypeResolveResponseJwt",
        "expected-result": "failure",
        "comment": "The entity has not been updated with the latest spec change on the anchor -> trust_anchor parameter name change on the resolve endpoint"
    },
    {
        "test-name": "openid-federation-compare-trust-chain-to-resolve",
        "variant": "*",
        "configuration-filename": "*sweden-federation-trust-anchor.json",
        "current-block": "*",
        "condition": "ExtractJWTFromFederationEndpointResponse",
        "expected-result": "failure",
        "comment": "The entity has not been updated with the latest spec change on the anchor -> trust_anchor parameter name change on the resolve endpoint"
    },

    {
        "test-name": "openid-federation-ensure-fetch-with-iss-as-sub-fails",
        "variant": "*",
        "configuration-filename": "*sweden-federation-trust-anchor.json",
        "current-block": "*",
        "condition": "EnsureInvalidRequestError",
        "expected-result": "warning",
        "comment": "Fails with not_found instead of invalid_request, which is fine"
    },
    {
        "test-name": "openid-federation-ensure-fetch-with-iss-as-sub-fails",
        "variant": "*",
        "configuration-filename": "*sweden-federation-intermediate.json",
        "current-block": "*",
        "condition": "EnsureInvalidRequestError",
        "expected-result": "warning",
        "comment": "Fails with not_found instead of invalid_request, which is fine"
    },
    {
        "test-name": "openid-federation-ensure-fetch-with-iss-as-sub-fails",
        "variant": "*",
        "configuration-filename": "*authlete-federation-trust-anchor.json",
        "current-block": "*",
        "condition": "EnsureInvalidRequestError",
        "expected-result": "warning",
        "comment": "Fails with not_found instead of invalid_request, which is fine"
    },

    {
        "test-name": "*",
        "variant": "*",
        "configuration-filename": "*",
        "current-block": "*",
        "condition": "CheckDiscEndpointUserinfoEndpoint",
        "expected-result": "warning",
        "comment": "This is a warning about missing userinfo endpoint, and we're not interested in that here"
    }
]
